{% include 'server/fields_table.html' with form=form_dict.form %}
<div class='accordion'>
    {% for fd in form_dict.object_form_dicts %}
        <div class='accordion-item'>
            <h2 class='accordion-header' id='{{ fd.form.prefix }}-header'>
                <button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#{{ fd.form.prefix }}' aria-expanded='false' aria-controls='{{ fd.form.prefix }}'>
                    {{ fd.name }}
                </button>
            </h2>
            <div id='{{ fd.form.prefix }}' class='accordion-collapse collapse' aria-labelledby='{{ fd.form.prefix }}-header'>
                <div class='accordion-body'>
                    {% include 'server/fields_form.html' with form_dict=fd %}
                </div>
            </div>
        </div>
    {% endfor %}
    {% for afd in form_dict.array_form_dicts %}
        <div class='accordion-item'>
            <h2 class='accordion-header' id='{{ afd.prefix_plural }}-header'>
                <button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#{{ afd.prefix_plural }}' aria-expanded='false' aria-controls='{{ afd.prefix_plural }}'>
                    {{ afd.plural }}
                </button>
            </h2>
            <div id='{{ afd.prefix_plural }}' class='accordion-collapse collapse' aria-labelledby='{{ afd.prefix_plural }}-header'>
                <div class='accordion-body'>
                    {% if afd.object_form_dicts|length %}
                        <ul class='nav nav-tabs' role='tablist'>
                            {% for fd in afd.object_form_dicts %}
                                {% with counter=forloop.counter|stringformat:'s' %}
                                    {% with tab_id=fd.form.prefix|add:'-'|add:counter %}
                                        <li class='nav-item' role='presentation'>
                                            <button class='nav-link {% if forloop.first %}active{% endif %}' id='{{ tab_id }}-tab' data-bs-toggle='tab' data-bs-target='#{{ tab_id }}' type='button' role='tab' aria-controls='{{ tab_id }}' aria-selected='{% if forloop.first %}true{% else %}false{% endif %}'>
                                                #{{ forloop.counter }}
                                            </button>
                                        </li>
                                    {% endwith %}
                                {% endwith %}
                            {% endfor %}
                        </ul>
                        <div class='tab-content'>
                            {% for fd in afd.object_form_dicts %}
                                {% with counter=forloop.counter|stringformat:'s' %}
                                    {% with tab_id=fd.form.prefix|add:'-'|add:counter %}
                                        <div class='tab-pane fade {% if forloop.first %}show active{% endif %}' id='{{ tab_id }}' role='tabpanel' aria-labelledby='{{ tab_id }}-tab'>
                                            {% include 'server/fields_form.html' with form_dict=fd %}
                                        </div>
                                    {% endwith %}
                                {% endwith %}
                            {% endfor %}
                        </div>
                    {% else %}
                        No {{ afd.plural }} have been added.
                    {% endif %}
                </div>
            </div>
        </div>
    {% endfor %}
</div>
